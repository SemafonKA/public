
## План

1. Вступление (тема диплома, фио)
2. Цель работы
3. Актуальность
4. 1. Проблемы бумажного документооборота
5. 2. Проблемы цифрового документооборота
6. Особенности распределённых реестров, как они устроены, почему они безопасны
7. Ethereum
8. Идея выдачи документов в виде NFT в Ethereum
9. Как была решена проблема валидации документов
10. Архитектура приложения
11. Демонстрация выдачи документов
12. Выводы
13. Титульник 

## Вступление

>[!info] Слайд 1. Титульник

Тут в целом и говорить особо нечево

## Введение

>[!info] Слайд 2. Введение: цели и задачи данной работы

Целью данной работы является разработка системы выдачи электронных 
сертификатов на основе технологии распределённого реестра. 

Для достижения цели были поставлены следующие задачи:

1. изучить и проанализировать принцип работы технологии распределённого реестра, 
выделить отличия различных реализаций данной технологии;
2. провести сравнение наиболее популярных сервисов, основанных на базе 
технологии распределённого реестра;
3. сформулировать требования для разработки системы выдачи электронных 
сертификатов;
4. разработать и протестировать полученный сервис.

## Актуальность темы

>[!info] Слайд 3. Бумажный документооборот - устаревает.
>
>Проблемы бумажного документооборота:
>
> 1. требует физического контакта эмитента с получателем
> 2. требует печати, ручных подписей
> 3. занимает физическое место
> 4. легко непреднамеренно испортить
> 5. действительность документа тяжелее проверить

На данный момент большая часть документооборота, связанного с образовательными документами и сертификатами, происходит в бумажном виде. Формат этот хоть и неплохой, но не без проблем. Наиболее заметные из них следующие:

- для передачи физического документа нужен личный контакт с получателем;
- его легко испортить;
- тяжело проверить не подделка ли это;
- тяжело отследить процесс выпуска документов.

В целом, данные проблемы отлично решаются путём перехода на электронный документооборот. Но электронные документы подделать ещё проще. Как тогда проверить, что документ действителен?

>[!info] Слайд 4. Электронный документооборот - проблема и её решение
> Основная проблема электронных документов - их гораздо легче подделать.
> 
> Возможные решения:
> 
> 1. Цифровая подпись (нужна организация, которая будет её проверять)
> 2. Хранение хэш-суммы сертификата в распределённом реестре

Для решения этой проблемы чаще всего применяется следующий метод. Эмитент получает от специальной организации сертификат соответствия, включающий в себя приватные и публичные ключи для подписи документов. Далее, при выпуске документа, эмитент подписывает хэш-сумму документа своим приватным ключом и прилагает её к документу в виде цифровой подписи. 

Сам метод достаточно простой и распространённый, но есть нюансы. "Специальных организаций" по миру крайне мало, стать ими практически невозможно, и все они чаще всего подконтрольны своему государству и, следовательно, санкциям, что может помешать процессу выпуска новых документов.

В качестве альтернативы мной предлагается замена цифровой подписи на хранение хэш-суммы документа в распределённых реестрах на базе блокчейн-сетей. Данный подход может дать следующие преимущества:

- независимость от конкретных организаций и санкций за счёт свободы и распространённости блокчейна по всему миру;
- открытость и прозрачность транзакций в блокчейне, что позволяет наблюдать за выпуском организацией любых документов (речь идёт в первую очередь про образовательные документы, поэтому здесь открытость приветствуется).

При этом криптографическая защищённость данных останется прежней, поскольку для публикации транзакций в сеть используются сходные алгоритмы шифрования и те же приватные/публичные ключи.

## Структура выдаваемого документа

>[!info] Слайд 5. Структура выдаваемых документов
> Документы будут выдаваться в формате JSON.  Структура этих документов будет следующей (справа).
> 
> В качестве распределённого реестра - блокчейн Ethereum

Выдаваемые документы будут храниться в формате JSON и иметь следующий набор полей, отображённых на слайде. Основные из них это:

- Название документа
- Описание документа
- Ссылка на графическое представление документа
- Публичные адреса эмитента и студента
- хэш-сумма документа

В данном формате документ будет храниться не в самом распределённом реестре, а, например, на личном сервере организации. Сделано это затем, что хранение данных в блокчейне является достаточно дорогим, поэтому непосредственно в самом блокчейне будет храниться лишь небольшая информация о самом документе:

- хэш-сумма документа,
- статус актуальности документа (отозван ли он или нет),
- адрес эмитента,
- адрес владельца (получателя сертификата),
- порядковый номер документа в базе данных.

```json
{
    "name": "Название документа",
    "description": "Описание документа",
    "external_url": "Внешнее представление документа",
    "attributes": [
        {
            "display_type": "number",
            "trait_type": "Номер сертификата в блокчейне",
            "value": "..."
        },
        {
            "trait_type": "Адрес смарт-контракта",
            "value": "..."
        },
        {
            "trait_type": "Публичный адрес студента",
            "value": "..."
        },
        {
            "trait_type": "Публичный адрес компании",
            "value": "..."
        },
        {
            "trait_type": "ФИО студента",
            "value": "..."
        },
        {
            "trait_type": "Название организации",
            "value": "..."
        },
        {
            "trait_type": "Местоположение организации",
            "value": "..."
        },
        {
            "trait_type": "Тип сертификата",
            "value": "..."
        },
        {
            "display_type": "date",
            "trait_type": "Дата создания сертификата",
            "value": "..."
        },
        {
            "trait_type": "Действителен ли сертификат?",
            "value": "..."
        },
        {
            "trait_type": "Дата отзыва сертификата",
            "value": "..."
        },
        {
            "trait_type": "Хэш-сумма сертификата",
            "value": "..."
        }
    ]
}
```

## Распределённый реестр

>[!note] Слайд 6. Ethereum - один из самых популярных распределённых реестров.
> 1. Давно на рынке, доказал свою надёжность
> 2. Активно развивается и не стоит на месте
> 3. Поддерживает исполнение программного кода в лице смарт-контрактов
> 4. Невзаимозаменяемые токены
> 
> NFT + хэш-сумма = способ заверения документов 

В качестве распределённого реестра будет использовать одна из наиболее известных блокчейн сетей Ethereum. Особенностью данной сети является возможность программирования и исполнения программного кода в виде смарт-контрактов прямо в рамках совершения транзакции в сети. 

Одним из наиболее популярных интерфейсов для смарт-контрактов в сети Ethereum является интерфейс IERC721, он же интерфейс невзаимозаменяемых токенов, они же NFT. Особенность NFT в том, что у одного токена может быть только 1 владелец и у каждого токена есть свой владелец. При этом гарантию того, что токенами может распоряжаться лишь их владелец, гарантирует программный код, исполняемый узлами реестра.

Для целей данной работы, стандарт был расширен следующим функционалом:

1. хранение не только владельца токена, но и его эмитента (для добавления возможности отзыва выданного документа)
2. функционал отзыва токена его эмитентом (если тот потерял актуальность), без удаления токена из блокчейн-сети
3. функционал получения хэш-суммы созданного токена

Помимо этого, смарт-контракт хранит порядковый номер выданного токена и базовый url-адрес сайта владельца хранилища документов. Таким образом, объединяя их, можно получить url-адрес на сам выданный документ.

## Разрабатываемое приложение

### Бэкенд

>[!note] Слайд 7. Разрабатываемое приложение - сервер
> Сервер: Python + FastAPI + Prisma ORM + Docker
> 
> База данных: PostgreSQL + Adminer

Для удобства работы с распределённым реестром, а также для хранения опубликованных сертификатов, был разработан сервис для выдачи электронных дипломов и сертификатов. Сервис имеет клиент-серверную архитектуру. Серверная часть состоит из двух частей:

1. Сам сервер, написанный с использованием фреймворка FastAPI
2. База данных, работающая на основе СУБД PostgreSQL

Основные задачи серверной части приложения:

1. Хранение информации об организациях, выдающих сертификаты
2. Хранение информации о студентах, добавленных организациями
3. Хранение и выдача информации о выданных дипломах и сертификатах
4. Взаимодействие со смарт-контрактом в сети Ethereum, в том числе публикация новых сертификатов

### Фронтенд

>[!note] Слайд 8. Разрабатываемое приложение - клиент
>Стек технологий: HTML, CSS, JS, Vue3, Electron

 Клиентское приложение разрабатывалось как кроссплатформенное на основе фреймворка Electron. Данный фреймворк позволяет разрабатывать приложения, которые можно собирать под большинство наиболее популярных платформ без необходимости платформенной адаптации программного кода. Разработка при этом на основе привычных web-технологий, поэтому основные этапы разработки не сильно отличаются от разработки web-приложения.

Клиентское приложение предназначено для организаций, позволяя:

1. Регистрировать новую организацию
2. Добавлять и управлять студентами своей организации
3. Загружать новые обложки для графического представления сертификатов
4. Выдавать новые сертификаты

## Фронтенд. Выдача документа

>[!note] Слайд 9. Выдача документов
>`<изображение загрузки нового сертификата>`

## Фронтенд. Просмотр документа

>[!note] Слайд 10. Просмотр выданного документа: JSON

```json
{
  "name": "О завершении разработки проекта",
  "description": "Сертификат, выданный студенту в честь завершения разработки проекта",
  "external_url": "http://127.0.0.1:8000/info/certs/id/1/view",
  "attributes": [
    {
      "display_type": "number",
      "trait_type": "Номер сертификата",
      "value": 1
    },
    {
      "trait_type": "Адрес смарт-контракта",
      "value": "0xf1f8d2f68afeAed904314a08fB125E2103Df50be"
    },
    {
      "trait_type": "Публичный адрес студента",
      "value": "0x14e6520397F8682231BC368B6Bbc51a2F47f2CF3"
    },
    {
      "trait_type": "Публичный адрес компании",
      "value": "0x99D48BfF35C14d96e9bf348b5e77604AC22649CD"
    },
    {
      "trait_type": "ФИО студента",
      "value": "Самсонов Семён Евгеньевич"
    },
    {
      "trait_type": "Название организации",
      "value": "Клио"
    },
    {
      "trait_type": "Местоположение организации",
      "value": "Новосибирск, Россия"
    },
    {
      "trait_type": "Тип сертификата",
      "value": "Сертификат"
    },
    {
      "display_type": "date",
      "trait_type": "Дата создания сертификата",
      "value": "25.7.2024"
    },
    {
      "trait_type": "Действителен ли сертификат?",
      "value": "Да"
    },
    {
      "trait_type": "Дата отзыва сертификата",
      "value": "Не отозван"
    },
    {
      "trait_type": "Хэш-сумма сертификата",
      "value": "843965c40a29993fc1ad0548a0818def07c9123d5ec785917b05db99e6812dae"
    }
  ]
}
```

>[!note] Слайд 11. Просмотр выданного документа: графика

## Заключение

>[!note] Слайд 12. Заключение
> - изучены и проанализированы принцип работы технологии распределённого реестра, выделить отличия различных реализаций данной технологии;
> - проведено сравнение наиболее популярных сервисов, основанных на базе технологии распределённого реестра;
> - сформулированы требования для разработки системы выдачи электронных сертификатов;
> - разработан и протестирован полученный сервис.
